<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kh√°m Ph√° B·∫£n Th√¢n - ƒê·ªãnh H∆∞·ªõng T∆∞∆°ng Lai</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap');
        body { font-family: 'Be Vietnam Pro', sans-serif; background: linear-gradient(135deg, #f6f8fd 0%, #f1f5f9 100%); color: #1e293b; padding-bottom: 50px; }
        .header-banner { background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%); color: white; padding: 40px 20px; text-align: center; border-radius: 0 0 40px 40px; box-shadow: 0 10px 30px rgba(37, 99, 235, 0.2); margin-bottom: 30px; }
        .card-custom { background: #ffffff; border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.05); border: none; padding: 30px; margin-bottom: 25px; }
        .form-control, .form-select { border-radius: 12px; padding: 12px 15px; border: 1px solid #cbd5e1; }
        .form-control:focus, .form-select:focus { box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1); border-color: #3b82f6; }
        .section-title { font-weight: 700; color: #2563eb; margin-bottom: 20px; border-bottom: 2px dashed #e2e8f0; padding-bottom: 10px; }
        .question-box { background: #f8fafc; padding: 20px; border-radius: 15px; margin-bottom: 15px; border: 1px solid #e2e8f0; }
        .question-box p { font-weight: 600; margin-bottom: 10px; color: #0f172a; }
        .form-check-label { cursor: pointer; color: #475569; }
        .dynamic-section { display: none; animation: fadeIn 0.5s; }
        .dropdown-menu-custom { width: 100%; padding: 15px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); border: 1px solid #e2e8f0; }
        .btn-submit { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); color: white; font-weight: 700; font-size: 1.2rem; padding: 15px; border-radius: 15px; border: none; transition: all 0.3s; }
        .btn-submit:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(245, 158, 11, 0.3); color: white;}
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .modal-content { border-radius: 20px; border: none; }
        .modal-header { background: #f8fafc; border-radius: 20px 20px 0 0; }
        .result-block { background: #eff6ff; padding: 15px; border-radius: 12px; margin-bottom: 15px; border-left: 5px solid #3b82f6; }
        #loading { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.9); z-index: 9999; text-align: center; padding-top: 20vh; }
    </style>
</head>
<body>

    <div class="header-banner">
        <h1 class="fw-bold">Kh√°m Ph√° T∆∞∆°ng Lai C√πng Vi·ªát M·ªπ</h1>
        <p class="fs-5 opacity-75 mb-0">ƒêi·ªÅn th√¥ng tin v√† l·ª±a ch·ªçn tr·∫£i nghi·ªám b·∫°n mu·ªën tham gia!</p>
    </div>

    <div class="container">
        <form id="mainForm">
            <div class="card-custom">
                <h4 class="section-title"><i class="fa-regular fa-id-card me-2"></i>Th√¥ng tin h·ªçc sinh</h4>
                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">H·ªç v√† t√™n *</label>
                        <input type="text" class="form-control" id="fullName" required placeholder="Nh·∫≠p h·ªç v√† t√™n...">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">Ng√†y th√°ng nƒÉm sinh *</label>
                        <input type="date" class="form-control" id="dob" required>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">SƒêT Zalo (Nh·∫≠n k·∫øt qu·∫£) *</label>
                        <input type="tel" class="form-control" id="zalo" required placeholder="V√≠ d·ª•: 0901234567">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold">ƒê·ªãa ch·ªâ</label>
                        <input type="text" class="form-control" id="address" placeholder="Qu·∫≠n/Huy·ªán, T·ªânh/Th√†nh...">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label fw-semibold">Em ƒëang h·ªçc THPT n√†o?</label>
                        <input type="text" class="form-control" id="school" placeholder="T√™n tr∆∞·ªùng...">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label fw-semibold">Ng√†nh ngh·ªÅ mu·ªën h·ªçc</label>
                        <input type="text" class="form-control" id="major" placeholder="V√≠ d·ª•: IT, Marketing...">
                    </div>
                    <div class="col-md-4">
                        <label class="form-label fw-semibold">Th·∫ßy C√¥ t∆∞ v·∫•n (N·∫øu c√≥)</label>
                        <input type="text" class="form-control" id="teacher" placeholder="T√™n Th·∫ßy/C√¥...">
                    </div>
                </div>
            </div>

            <div class="card-custom">
                <h4 class="section-title"><i class="fa-solid fa-list-check me-2"></i>Ch·ªçn tr·∫£i nghi·ªám b·∫°n mu·ªën tham gia</h4>
                <div class="dropdown">
                    <button class="btn btn-outline-primary w-100 text-start d-flex justify-content-between align-items-center p-3 fw-semibold" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false" style="border-radius: 12px; font-size: 1.1rem;">
                        <span>Vui l√≤ng ch·ªçn c√°c m·ª•c b√™n d∆∞·ªõi...</span>
                        <i class="fa-solid fa-chevron-down"></i>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-custom" aria-labelledby="dropdownMenuButton" onclick="event.stopPropagation()">
                        <li>
                            <div class="form-check fs-5 mb-2">
                                <input class="form-check-input check-experience" type="checkbox" value="sec-grad" id="chkGrad">
                                <label class="form-check-label fw-medium" for="chkGrad">üéØ Xem t·ª∑ l·ªá ƒë·ªó t·ªët nghi·ªáp</label>
                            </div>
                        </li>
                        <li>
                            <div class="form-check fs-5 mb-2">
                                <input class="form-check-input check-experience" type="checkbox" value="sec-holland" id="chkHolland">
                                <label class="form-check-label fw-medium" for="chkHolland">üß† Tr·∫Øc nghi·ªám t√≠nh c√°ch Holland</label>
                            </div>
                        </li>
                        <li>
                            <div class="form-check fs-5">
                                <input class="form-check-input check-experience" type="checkbox" value="sec-lucky" id="chkLucky">
                                <label class="form-check-label fw-medium" for="chkLucky">üßß ƒêƒÉng k√Ω nh·∫≠n m√£ quay s·ªë L√å X√å</label>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>

            <div id="sec-grad" class="card-custom dynamic-section">
                <h4 class="section-title text-warning"><i class="fa-solid fa-fire me-2"></i>Xem t·ª∑ l·ªá ƒë·ªó t·ªët nghi·ªáp</h4>
                
                <div class="question-box">
                    <p>C√¢u 1Ô∏è‚É£ G·∫ßn ng√†y thi, t√¢m tr·∫°ng h·ªçc t·∫≠p c·ªßa b·∫°n l√†:</p>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g1" value="A"> <label class="form-check-label">A. V·∫´n h·ªçc ƒë·ªÅu, kh√¥ng qu√° ho·∫£ng üòé</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g1" value="B"> <label class="form-check-label">B. C√≥ h∆°i √°p l·ª±c nh∆∞ng v·∫´n c·ªë g·∫Øng üìö</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g1" value="C"> <label class="form-check-label">C. H·ªçc tr∆∞·ªõc qu√™n sau, h∆°i r·ªëi üòµ</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g1" value="D"> <label class="form-check-label">D. Nghƒ© t·ªõi thi l√† th·∫•y cƒÉng li·ªÅn ü´†</label></div>
                </div>
                <div class="question-box">
                    <p>C√¢u 2Ô∏è‚É£ M·ªói ng√†y b·∫°n d√†nh bao l√¢u ƒë·ªÉ √¥n b√†i?</p>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g2" value="A"> <label class="form-check-label">A. Tr√™n 3 ti·∫øng ‚è∞</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g2" value="B"> <label class="form-check-label">B. 1‚Äì2 ti·∫øng ‚è±Ô∏è</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g2" value="C"> <label class="form-check-label">C. Khi n√†o r·∫£nh m·ªõi √¥n üòÖ</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g2" value="D"> <label class="form-check-label">D. Ch·ªß y·∫øu l√†‚Ä¶ ƒë·ªÉ mai üì±</label></div>
                </div>
                <div class="question-box">
                    <p>C√¢u 3Ô∏è‚É£ K·∫øt qu·∫£ c√°c b√†i ki·ªÉm tra/thi th·ª≠ g·∫ßn ƒë√¢y c·ªßa b·∫°n:</p>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g3" value="A"> <label class="form-check-label">A. Ph·∫ßn l·ªõn tr√™n 7 ƒëi·ªÉm üëç</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g3" value="B"> <label class="form-check-label">B. Kho·∫£ng 6‚Äì7 ƒëi·ªÉm</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g3" value="C"> <label class="form-check-label">C. D∆∞·ªõi 6 ƒëi·ªÉm</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g3" value="D"> <label class="form-check-label">D. Kh√¥ng ·ªïn ƒë·ªãnh, l√∫c ƒë∆∞·ª£c l√∫c kh√¥ng üò≠</label></div>
                </div>
                <div class="question-box">
                    <p>C√¢u 4Ô∏è‚É£ Khi g·∫∑p c√¢u kh√≥ trong ƒë·ªÅ, b·∫°n th∆∞·ªùng:</p>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g4" value="A"> <label class="form-check-label">A. B·ªè qua, l√†m c√¢u d·ªÖ tr∆∞·ªõc r·ªìi quay l·∫°i üí°</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g4" value="B"> <label class="form-check-label">B. Nghƒ© m·ªôt l√∫c r·ªìi ch·ªçn ƒë√°p √°n h·ª£p l√Ω</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g4" value="C"> <label class="form-check-label">C. L√†m ƒë·∫°i cho k·ªãp gi·ªù</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g4" value="D"> <label class="form-check-label">D. Ng·ªìi nh√¨n ƒë·ªìng h·ªì ch·∫°y ‚è∞üò∂</label></div>
                </div>
                <div class="question-box">
                    <p>C√¢u 5Ô∏è‚É£ Khi nh√¨n ƒë·ªÅ thi th·ª≠, c·∫£m gi√°c c·ªßa b·∫°n l√†:</p>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g5" value="A"> <label class="form-check-label">A. Nhi·ªÅu c√¢u quen, l√†m ƒë∆∞·ª£c ngay</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g5" value="B"> <label class="form-check-label">B. C√≥ quen c√≥ l·∫°</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g5" value="C"> <label class="form-check-label">C. Th·∫•y l·∫° l√† nhi·ªÅu</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="g5" value="D"> <label class="form-check-label">D. Nh√¨n m√† mu·ªën‚Ä¶ quay xe ü´†</label></div>
                </div>
            </div>

            <div id="sec-holland" class="card-custom dynamic-section">
                <h4 class="section-title text-success"><i class="fa-solid fa-puzzle-piece me-2"></i>Tr·∫Øc nghi·ªám Holland</h4>
                
                <div class="question-box">
                    <p>1. N·∫øu chi·∫øc xe ƒë·∫°p/m√°y t√≠nh b·ªã h·ªèng, b·∫°n s·∫Ω:</p>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h1" value="A"> <label class="form-check-label">A. M·ªü ra v√† m√†y m√≤ t√¨m hi·ªÉu c·∫•u t·∫°o, th·ª≠ t·ª± s·ª≠a ch·ªØa.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h1" value="B"> <label class="form-check-label">B. T√¨m ki·∫øm c√°c t√†i li·ªáu, video h∆∞·ªõng d·∫´n chi ti·∫øt.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h1" value="C"> <label class="form-check-label">C. Thu√™ m·ªôt ng∆∞·ªùi th·ª£ gi·ªèi ƒë·∫øn s·ª≠a v√† quan s√°t c√°ch h·ªç l√†m.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h1" value="D"> <label class="form-check-label">D. K√™u g·ªçi b·∫°n b√® ho·∫∑c ng∆∞·ªùi th√¢n gi√∫p ƒë·ª°.</label></div>
                </div>
                <div class="question-box">
                    <p>2. N·∫øu ƒë∆∞·ª£c ch·ªçn m·ªôt m√¥n h·ªçc ngo·∫°i kh√≥a, b·∫°n th√≠ch nh·∫•t:</p>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h2" value="A"> <label class="form-check-label">A. CLB D·ª±ng phim ng·∫Øn ho·∫∑c Thi·∫øt k·∫ø th·ªùi trang.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h2" value="B"> <label class="form-check-label">B. CLB T√¨nh nguy·ªán H·ªó tr·ª£ tr·∫ª em kh√≥ khƒÉn.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h2" value="C"> <label class="form-check-label">C. CLB Kh·ªüi nghi·ªáp & Kinh doanh.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h2" value="D"> <label class="form-check-label">D. CLB Nghi√™n c·ª©u Robot ho·∫∑c Gi·∫£i quy·∫øt m√¥ h√¨nh V·∫≠t l√Ω.</label></div>
                </div>
                <div class="question-box">
                    <p>3. Trong m·ªôt d·ª± √°n nh√≥m, vai tr√≤ n√†o khi·∫øn b·∫°n h√†o h·ª©ng nh·∫•t?</p>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h3" value="A"> <label class="form-check-label">A. Ng∆∞·ªùi thu th·∫≠p, s·∫Øp x·∫øp d·ªØ li·ªáu, l·ªãch tr√¨nh.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h3" value="B"> <label class="form-check-label">B. Ng∆∞·ªùi l√™n √Ω t∆∞·ªüng l·ªõn, "b√°n" √Ω t∆∞·ªüng.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h3" value="C"> <label class="form-check-label">C. Ng∆∞·ªùi th·ª±c hi·ªán t·∫°o h√¨nh, ƒë·ªì h·ªça, vi·∫øt l·ªùi vƒÉn.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h3" value="D"> <label class="form-check-label">D. Ng∆∞·ªùi h∆∞·ªõng d·∫´n, l·∫Øng nghe v√† h√≤a gi·∫£i m√¢u thu·∫´n.</label></div>
                </div>
                <div class="question-box">
                    <p>4. Khi ƒë·ªçc m·ªôt b√†i b√°o/t√†i li·ªáu m·ªõi, ƒëi·ªÅu g√¨ h·∫•p d·∫´n b·∫°n nh·∫•t?</p>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h4" value="A"> <label class="form-check-label">A. C√°c th√¥ng tin v·ªÅ con s·ªë, bi·ªÉu ƒë·ªì, quy tr√¨nh.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h4" value="B"> <label class="form-check-label">B. C√°c gi·∫£ thuy·∫øt khoa h·ªçc, b·∫±ng ch·ª©ng logic.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h4" value="C"> <label class="form-check-label">C. C√¢u chuy·ªán truy·ªÅn c·∫£m h·ª©ng v·ªÅ ng∆∞·ªùi th√†nh c√¥ng.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h4" value="D"> <label class="form-check-label">D. C√°c √Ω t∆∞·ªüng thi·∫øt k·∫ø, ng√¥n ng·ªØ gi√†u h√¨nh ·∫£nh.</label></div>
                </div>
                <div class="question-box">
                    <p>5. Trong th·ªùi gian r·∫£nh, b·∫°n th√≠ch nh·∫•t l√†m g√¨?</p>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h5" value="A"> <label class="form-check-label">A. ƒê·ª©ng l·ªõp, d·∫°y l·∫°i ki·∫øn th·ª©c ho·∫∑c l√†m gia s∆∞.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h5" value="B"> <label class="form-check-label">B. L√†m v∆∞·ªùn, t·∫≠p th·ªÉ h√¨nh, ph∆∞·ª£t ho·∫∑c l·∫Øp r√°p m√¥ h√¨nh.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h5" value="C"> <label class="form-check-label">C. Vi·∫øt nh·∫≠t k√Ω, s√°ng t√°c nh·∫°c, v·∫Ω, thi·∫øt k·∫ø ph√≤ng.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h5" value="D"> <label class="form-check-label">D. L√™n k·∫ø ho·∫°ch chi ti√™u, s·∫Øp x·∫øp m√°y t√≠nh.</label></div>
                </div>
                <div class="question-box">
                    <p>6. Gi·∫£ s·ª≠ b·∫°n t√¨m ƒë∆∞·ª£c m·ªôt s·ªë ti·ªÅn, b·∫°n s·∫Ω:</p>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h6" value="A"> <label class="form-check-label">A. D√πng ti·ªÅn ƒë·∫ßu t∆∞, kinh doanh nh·ªè xem sinh l·ªùi.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h6" value="B"> <label class="form-check-label">B. Ph√¢n t√≠ch ngu·ªìn g·ªëc ti·ªÅn v√† t√¨m ch·ªß nh√¢n tr·∫£ l·∫°i.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h6" value="C"> <label class="form-check-label">C. D√πng ti·ªÅn t·ªï ch·ª©c s·ª± ki·ªán, ti·ªác cho b·∫°n b√®.</label></div>
                    <div class="form-check"><input class="form-check-input" type="radio" name="h6" value="D"> <label class="form-check-label">D. Mua thi·∫øt b·ªã c·∫ßn thi·∫øt ph·ª•c v·ª• s·ªü th√≠ch c√° nh√¢n.</label></div>
                </div>
            </div>

            <div id="sec-lucky" class="card-custom dynamic-section text-center">
                <h4 class="section-title text-danger"><i class="fa-solid fa-gift me-2"></i>ƒêƒÉng k√Ω L√¨ X√¨ Khai Xu√¢n</h4>
                <p class="fs-5 text-muted">H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông sinh m√£ s·ªë may m·∫Øn cho b·∫°n ngay khi b·∫•m G·ª≠i!</p>
                <div style="font-size: 60px;">üßß</div>
            </div>

            <button type="submit" class="btn btn-submit w-100 mt-2" id="btnSubmitAll">
                G·ª¨I TH√îNG TIN V√Ä XEM K·∫æT QU·∫¢ <i class="fa-solid fa-paper-plane ms-2"></i>
            </button>
        </form>
    </div>

    <div id="loading">
        <div class="spinner-border text-primary" style="width: 4rem; height: 4rem;" role="status"></div>
        <h3 class="mt-4 text-primary fw-bold">ƒêang x·ª≠ l√Ω d·ªØ li·ªáu th√¥ng minh...</h3>
        <p>Vui l√≤ng ƒë·ª£i trong gi√¢y l√°t</p>
    </div>

    <div class="modal fade" id="resultModal" tabindex="-1" aria-hidden="true" data-bs-backdrop="static">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title fw-bold text-primary">Tada! K·∫øt qu·∫£ c·ªßa b·∫°n ƒë√¢y üéâ</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-4" id="resultBody"></div>
                <div class="modal-footer justify-content-center border-0">
                    <p class="text-muted w-100 text-center mb-0">D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c b·∫£o m·∫≠t v√† g·ª≠i ƒë·∫øn Ban Tuy·ªÉn Sinh Vi·ªát M·ªπ.</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 1. C·∫§U H√åNH API GOOGLE SHEETS ·ªû ƒê√ÇY
        const GOOGLE_SCRIPT_URL = "D√ÅN_LINK_WEB_APP_URL_C·ª¶A_B·∫†N_V√ÄO_ƒê√ÇY";

        // 2. LOGIC HI·ªÇN TH·ªä C√ÅC KH·ªêI TEST (Dropdown)
        const checkBoxes = document.querySelectorAll('.check-experience');
        const btnDropdown = document.getElementById('dropdownMenuButton');

        checkBoxes.forEach(cb => {
            cb.addEventListener('change', function() {
                document.getElementById(this.value).style.display = this.checked ? 'block' : 'none';
                let checkedCount = document.querySelectorAll('.check-experience:checked').length;
                btnDropdown.querySelector('span').innerText = checkedCount === 0 ? "Vui l√≤ng ch·ªçn c√°c m·ª•c b√™n d∆∞·ªõi..." : `ƒê√£ ch·ªçn ${checkedCount} tr·∫£i nghi·ªám`;
                
                const section = document.getElementById(this.value);
                const radios = section.querySelectorAll('input[type="radio"]');
                radios.forEach(r => r.required = this.checked); // B·∫Øt bu·ªôc ch·ªçn ƒë√°p √°n n·∫øu ƒë√£ tick l√†m test
            });
        });

        // 3. T√çNH TO√ÅN V√Ä X·ª¨ L√ù KHI B·∫§M G·ª¨I
        document.getElementById('mainForm').addEventListener('submit', function(e) {
            e.preventDefault();
            document.getElementById('loading').style.display = 'block';

            let formData = new FormData(this);
            
            // Kh·ªüi t·∫°o Object ch·ª©a T·∫§T C·∫¢ th√¥ng tin bao g·ªìm c·∫£ c√¢u tr·∫£ l·ªùi chi ti·∫øt
            let finalData = {
                fullName: document.getElementById('fullName').value,
                dob: document.getElementById('dob').value,
                zalo: document.getElementById('zalo').value,
                address: document.getElementById('address').value,
                school: document.getElementById('school').value,
                major: document.getElementById('major').value,
                teacher: document.getElementById('teacher').value,
                
                g1: "", g2: "", g3: "", g4: "", g5: "", gradResult: "",
                h1: "", h2: "", h3: "", h4: "", h5: "", h6: "", hollandResult: "",
                luckyCode: ""
            };

            let resultHTML = "";

            // A. T√çNH T·ªà L·ªÜ T·ªêT NGHI·ªÜP
            if(document.getElementById('chkGrad').checked) {
                let counts = { A: 0, B: 0, C: 0, D: 0 };
                for(let i=1; i<=5; i++) {
                    let ans = formData.get('g'+i);
                    finalData['g'+i] = ans || ""; 
                    if(ans) counts[ans]++;
                }
                
                let maxChar = 'A', maxCount = counts['A'];
                for(let key in counts) { if(counts[key] > maxCount) { maxChar = key; maxCount = counts[key]; } }

                resultHTML += `<div class="result-block"><h5 class="fw-bold text-warning"><i class="fa-solid fa-fire"></i> T·ª∑ l·ªá ƒë·ªó t·ªët nghi·ªáp</h5>`;
                if(maxChar === 'A') {
                    resultHTML += `<p class="mb-0">üåü <b>80‚Äì95%</b>: B·∫°n ƒëang ·ªü ‚Äúv√πng an to√†n‚Äù r·ªìi ƒë√≥! Gi·ªØ phong ƒë·ªô nh√©.</p>`;
                    finalData.gradResult = "80-95% (An to√†n)";
                } else if(maxChar === 'B') {
                    resultHTML += `<p class="mb-0">üëç <b>65‚Äì80%</b>: ·ªîn √°p r·ªìi, ch·ªâ c·∫ßn tƒÉng t·ªëc ch√∫t x√≠u l√† b·ª©t ph√° ngay.</p>`;
                    finalData.gradResult = "65-80% (Kh√° ·ªïn)";
                } else if(maxChar === 'C') {
                    resultHTML += `<p class="mb-0">‚ö†Ô∏è <b>50‚Äì65%</b>: Ch∆∞a qu√° mu·ªôn ƒë√¢u! Ch·ªânh l·∫°i chi·∫øn thu·∫≠t √¥n t·∫≠p t·ª´ b√¢y gi·ªù.</p>`;
                    finalData.gradResult = "50-65% (C·∫ßn c·ªë g·∫Øng)";
                } else {
                    resultHTML += `<p class="mb-0">üí™ <b>D∆∞·ªõi 50%</b>: ƒê·ª´ng ho·∫£ng! V·∫´n c√≤n th·ªùi gian ƒë·ªÉ ‚Äúl·∫≠t k√®o‚Äù. B·∫Øt ƒë·∫ßu √¥n ngay h√¥m nay.</p>`;
                    finalData.gradResult = "D∆∞·ªõi 50% (C·∫ßn b·ª©t ph√°)";
                }
                resultHTML += `</div>`;
            }

            // B. T√çNH TEST HOLLAND
            if(document.getElementById('chkHolland').checked) {
                const hollandMap = {
                    h1: {A: 'R', B: 'C', C: 'E', D: 'S'}, h2: {A: 'A', B: 'S', C: 'E', D: 'I'},
                    h3: {A: 'C', B: 'E', C: 'A', D: 'S'}, h4: {A: 'C', B: 'I', C: 'E', D: 'A'},
                    h5: {A: 'S', B: 'R', C: 'A', D: 'C'}, h6: {A: 'E', B: 'I', C: 'S', D: 'R'}
                };
                const hollandInfo = {
                    R: { t: "Th·ª±c t·∫ø", j: "K·ªπ thu·∫≠t, C∆° kh√≠, C√¥ng ngh·ªá..." }, I: { t: "Nghi√™n c·ª©u", j: "Y D∆∞·ª£c, CNTT, Khoa h·ªçc..." },
                    A: { t: "Ngh·ªá thu·∫≠t", j: "Thi·∫øt k·∫ø, √Çm nh·∫°c, Truy·ªÅn th√¥ng..." }, S: { t: "X√£ h·ªôi", j: "Gi√°o d·ª•c, Y t·∫ø, T∆∞ v·∫•n..." },
                    E: { t: "Qu·∫£n l√Ω", j: "QTKD, Marketing, T√†i ch√≠nh..." }, C: { t: "Nghi·ªáp v·ª•", j: "K·∫ø to√°n, H√†nh ch√≠nh, Th∆∞ k√Ω..." }
                };
                
                let scores = { R:0, I:0, A:0, S:0, E:0, C:0 };
                for(let i=1; i<=6; i++) {
                    let ans = formData.get('h'+i);
                    finalData['h'+i] = ans || ""; 
                    if(ans) scores[hollandMap['h'+i][ans]]++;
                }

                let sorted = Object.keys(scores).sort((a, b) => scores[b] - scores[a]);
                let top3 = `${sorted[0]} - ${sorted[1]} - ${sorted[2]}`;
                let mainTrait = sorted[0];

                resultHTML += `<div class="result-block border-left-success" style="border-left-color: #22c55e;"><h5 class="fw-bold text-success"><i class="fa-solid fa-puzzle-piece"></i> ƒê·ªãnh h∆∞·ªõng ngh·ªÅ nghi·ªáp</h5>
                <p class="mb-1">M√£ Holland c·ªßa b·∫°n: <b>${top3}</b></p>
                <p class="mb-1">Nh√≥m n·ªïi tr·ªôi: <b>${hollandInfo[mainTrait].t}</b></p>
                <p class="mb-0 text-muted">Ng√†nh ph√π h·ª£p: ${hollandInfo[mainTrait].j}</p></div>`;
                
                finalData.hollandResult = `${top3} (${hollandInfo[mainTrait].t})`;
            }

            // C. T·∫†O M√É L√å X√å
            if(document.getElementById('chkLucky').checked) {
                const today = new Date();
                const yy = String(today.getFullYear()).slice(-2);
                const mm = String(today.getMonth() + 1).padStart(2, '0');
                const dd = String(today.getDate()).padStart(2, '0');
                const randomId = String(Math.floor(Math.random() * 900) + 100);
                const code = yy + mm + dd + randomId;

                resultHTML += `<div class="result-block border-left-danger" style="border-left-color: #ef4444;"><h5 class="fw-bold text-danger"><i class="fa-solid fa-gift"></i> M√£ L√¨ X√¨ C·ªßa B·∫°n</h5>
                <h3 class="fw-bold text-center my-3 p-2 bg-white rounded border border-danger">${code}</h3>
                <p class="mb-0 text-center text-muted small">H√£y l∆∞u l·∫°i m√£ n√†y ƒë·ªÉ nh·∫≠n l·ªôc t·ª´ Vi·ªát M·ªπ nh√©!</p></div>`;
                
                finalData.luckyCode = code;
            }

            if(resultHTML === "") {
                resultHTML = "<p class='text-center fs-5'>B·∫°n ƒë√£ g·ª≠i th√¥ng tin th√†nh c√¥ng nh∆∞ng ch∆∞a ch·ªçn l√†m b√†i tr·∫Øc nghi·ªám n√†o. TVTS s·∫Ω s·ªõm li√™n h·ªá cho b·∫°n!</p>";
            }

            // G·ª¨I D·ªÆ LI·ªÜU ƒê·∫æN GOOGLE SHEETS
            if(GOOGLE_SCRIPT_URL !== "https://script.google.com/macros/s/AKfycbzl7_LEK1TzqTLIXOWchmHpVUYDxF9rrD3BfzNhfv3Jr2eaGIYriwwrmGrBcmuw7x_8Jw/exec") {
                fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(finalData)
                }).then(() => {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('resultBody').innerHTML = resultHTML;
                    new bootstrap.Modal(document.getElementById('resultModal')).show();
                    
                    document.getElementById('mainForm').reset();
                    document.querySelectorAll('.dynamic-section').forEach(el => el.style.display = 'none');
                    btnDropdown.querySelector('span').innerText = "Vui l√≤ng ch·ªçn c√°c m·ª•c b√™n d∆∞·ªõi...";
                }).catch(err => {
                    console.error("L·ªói:", err);
                    alert("C√≥ l·ªói x·∫£y ra khi l∆∞u d·ªØ li·ªáu, vui l√≤ng th·ª≠ l·∫°i!");
                    document.getElementById('loading').style.display = 'none';
                });
            } else {
                setTimeout(() => {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('resultBody').innerHTML = resultHTML + "<hr><p class='text-danger text-center small'><i>L∆∞u √Ω: B·∫°n ch∆∞a nh·∫≠p Link Google Script n√™n d·ªØ li·ªáu ch∆∞a ƒë∆∞·ª£c ƒë·∫©y sang sheet.</i></p>";
                    new bootstrap.Modal(document.getElementById('resultModal')).show();
                }, 1000);
            }
        });
    </script>
</body>
</html>
